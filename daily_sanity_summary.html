<div style="height:100%; width: 100%; min-height: 700px;" class="InsightsContainer"> 
<script type="text/javascript" src="https://insights-6.qtestnet.com/rdTemplate/rdEmbedApi/rdEmbed.js"></script> 
<script> 
if(document.getElementsByClassName("Class_embeddedviewer").length == 0) { 
sessionStorage.scriptEmbedRunning = false; 
} 
var embedStyling = document.createElement("style"); 
embedStyling.type = "text/css"; 
embedStyling.innerHTML = ".InsightsEmbeddedReport, .InsightsEmbeddedReport iframe { height: inherit; min-height: inherit; }"; 
document.body.appendChild(embedStyling); 
(function (script, skip) { 
var embedCaller = arguments.callee; 
var thisScript; 
if (!script) { 
thisScript = document.currentScript || (function() { 
var scripts = document.getElementsByTagName("script"); 
return scripts[scripts.length - 1]; 
})(); 
} else { 
thisScript = script; 
} 
if(thisScript.parentNode.getElementsByClassName("insightEmbedScriptMessage").length < 1) { 
var message = document.createElement("span"); 
message.setAttribute("class", "insightEmbedScriptMessage"); 
thisScript.parentNode.appendChild(message); 
} 
thisScript.parentNode.getElementsByClassName("insightEmbedScriptMessage")[0].innerHTML = "Insights embedded script is processing"; 
if(!skip) { 
var timeDelay = Math.floor(Math.random() * 3000); 
setTimeout(function() { 
console.log("Delay: " + timeDelay); 
embedCaller(thisScript, true); 
}, timeDelay); 
} else { 
console.log("sessionStorage.scriptEmbedRunning=" + sessionStorage.scriptEmbedRunning); 
if(sessionStorage.scriptEmbedRunning == "true") { 
console.log("Another script is running. Delay"); 
thisScript.parentNode.getElementsByClassName("insightEmbedScriptMessage")[0].innerHTML = "Waiting for another Insights embedded script finish running"; 
setTimeout(function() { 
console.log( "Run delayed script"); 
embedCaller(thisScript, true); 
}, 5000); 
} else { 
console.log("Start running embed script to render report"); 
thisScript.parentNode.getElementsByClassName("insightEmbedScriptMessage")[0].innerHTML = "Insights embedded script is running"; 
sessionStorage.scriptEmbedRunning = true; 
var pingReq = new XMLHttpRequest(); 
pingReq.onreadystatechange = function() { 
if (this.readyState == XMLHttpRequest.DONE && (this.status == 200 || this.status == 404)) { 
var resPing = this.responseText; 
if (this.status == 200 && resPing.indexOf("pingOK") > 0) { 
var embedReportId = "embedded_" + new Date().getTime(); 
var embedReport = document.createElement("div"); 
embedReport.setAttribute("id", embedReportId ); 
embedReport.setAttribute("class", "InsightsEmbeddedReport"); 
var options = {}; 
options.applicationUrl = "https://insights-6.qtestnet.com"; 
options.report = "Combined.qTestManager"; 
options.linkParams = {"rdClass":"Class_clientEmbeddedReport","rdAgReset":"True","rdLoadBookmark":"True","rdBookmarkCollection":"user_bkmk_228993","rdBookmarkID":"63c54c13-0858-46d6-b224-69e9e5357773","savedBkmkName":"Execution Report of Daily Sanity in ITE1 and ITE2 Environment"}; 
options.autoSizing = "all"; 
thisScript.parentNode.appendChild(embedReport); 
EmbeddedReporting.create(embedReportId, options); 
console.log("Render embed report Combined.qTestManager"); 
sessionStorage.scriptEmbedRunning = false; 
thisScript.parentNode.removeChild(thisScript.parentNode.getElementsByClassName("insightEmbedScriptMessage")[0]); 
} else { 
var xhrGetKey = new XMLHttpRequest(); 
var urlGetKey = "https://vodafoneziggo.qtestnet.com/insights-api/securekey"; 
xhrGetKey.open("POST", urlGetKey, true); 
xhrGetKey.setRequestHeader("Content-type", "application/x-www-form-urlencoded;charset=utf-8"); 
xhrGetKey.onreadystatechange = function () { 
if (this.readyState == XMLHttpRequest.DONE) { 
if(this.status == 200) { 
var secureKey = this.responseText; 
console.log("Got Insights secureKey=" + secureKey); 
var embedReportId = "embedded_" + new Date().getTime(); 
var embedReport = document.createElement("div"); 
embedReport.setAttribute("id", embedReportId ); 
embedReport.setAttribute("class", "InsightsEmbeddedReport"); 
var options = {}; 
options.applicationUrl = "https://insights-6.qtestnet.com"; 
options.report = "Combined.qTestManager"; 
options.linkParams = {"rdClass":"Class_clientEmbeddedReport","rdAgReset":"True","rdLoadBookmark":"True","rdBookmarkCollection":"user_bkmk_228993","rdBookmarkID":"63c54c13-0858-46d6-b224-69e9e5357773","savedBkmkName":"Execution Report of Daily Sanity in ITE1 and ITE2 Environment"}; 
options.autoSizing = "all"; 
options.secureKey = secureKey; 
console.log("Render embed report Combined.qTestManager"); 
thisScript.parentNode.appendChild(embedReport); 
EmbeddedReporting.create(embedReportId, options); 
thisScript.parentNode.removeChild(thisScript.parentNode.getElementsByClassName("insightEmbedScriptMessage")[0]); 
} else { 
var message = "Could not get Insights secureKey, current URL: " + window.location.href + ", request to URL: " + urlGetKey+ ".Response status:" + this.status + ", body:" + this.responseText ; 
console.log(message); 
thisScript.parentNode.getElementsByClassName("insightEmbedScriptMessage")[0].innerHTML = message 
} 
sessionStorage.scriptEmbedRunning = false; 
} 
} 
xhrGetKey.withCredentials = true; 
xhrGetKey.send('token=NDQzNzI7dm9kYWZvbmV6aWdnbw=='); 
} 
} else if(this.readyState == XMLHttpRequest.DONE) { 
sessionStorage.scriptEmbedRunning = false; 
var message = "Ping Insights server error. (URL: " + "https://insights-6.qtestnet.com/rdTemplate/rdData.aspx?rdData=Embed&rdDataID=ping)"; 
console.log(message); 
thisScript.parentNode.getElementsByClassName("insightEmbedScriptMessage")[0].innerHTML = message 
} 
}; 
pingReq.open("GET", "https://insights-6.qtestnet.com/rdTemplate/rdData.aspx?rdData=Embed&rdDataID=ping&xx" + Math.random(), true ); 
pingReq.withCredentials = true; 
pingReq.setRequestHeader("Content-type", "text/plain"); 
pingReq.send(); 
}}})(); 
</script> 
</div> 
